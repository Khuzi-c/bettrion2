<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Emails - Bettrion Admin</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/admin.css">
</head>

<body>
    <div class="admin-sidebar" id="admin-sidebar-placeholder">
        <!-- Injected by admin.js -->
    </div>

    <div class="main-content">
        <h1>Email Management</h1>

        <div class="card">
            <h3>Send Email to User</h3>
            <form id="email-form">
                <input type="text" id="user-id" placeholder="User ID" required
                    style="width:100%; margin-bottom:10px; padding:10px;">
                <input type="text" id="subject" placeholder="Subject" required
                    style="width:100%; margin-bottom:10px; padding:10px;">
                <textarea id="html" placeholder="HTML Content..." required
                    style="width:100%; height:150px; margin-bottom:10px; padding:10px;"></textarea>
                <button type="submit" class="btn-primary">Send Email</button>
            </form>
        </div>

        <div class="card" style="margin-top:20px;">
            <h3>Coming Soon</h3>
            <p>Templates and Bulk Emailing support will be added here.</p>
        </div>
    </div>

    <script src="/assets/js/api.js"></script>
    <script src="/assets/js/admin.js"></script>
    <script>
        document.getElementById('email-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('user-id').value;
            const subject = document.getElementById('subject').value;
            const html = document.getElementById('html').value;

            try {
                // Check if user exists first? Nah, just send
                const res = await API.post(`/admin/users/${id}/email`, { subject, html });
                if (res.success) {
                    alert('Email Sent!');
                    document.getElementById('email-form').reset();
                }
            } catch (e) { alert(e.message); }
        });
    </script>
</body>

</html>